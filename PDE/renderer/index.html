<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PDE</title>
  <style>
    /* ----- ê¸°ë³¸ ì„¤ì • ----- */
    body {
      margin: 0;
      overflow: hidden; /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
      background: #1e1e1e;
      font-family: sans-serif;
      color: #f0f0f0;
      /* UI ìš”ì†Œì˜ í…ìŠ¤íŠ¸ê°€ ì‹¤ìˆ˜ë¡œ ë“œë˜ê·¸(ì„ íƒ)ë˜ëŠ” ê²ƒì„ ë°©ì§€ */
      user-select: none;
    }

    canvas {
      display: block;
    }

    #main-content {
        position: absolute;
        top: 40px; /* ìƒë‹¨ íˆ´ë°” ë†’ì´ */
        left: 200px; /* ì¢Œì¸¡ ì‚¬ì´ë“œë°” ë„ˆë¹„ */
        right: 240px; /* ìš°ì¸¡ ì‚¬ì´ë“œë°” ë„ˆë¹„ */
        bottom: 0;
        overflow: hidden;
    }
    
    #renderCanvas {
        width: 100%;
        height: 100%;
        display: block;
    }

    /* ----- ê°œë³„ UI íŒ¨ë„ ê³µí†µ ìŠ¤íƒ€ì¼ ----- */
    .ui-panel {
      position: absolute; /* bodyë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì ˆëŒ€ ìœ„ì¹˜ì— ë°°ì¹˜ */
      background-color: #2a2a2e;
      border: 1px solid #3a3a3e;
      box-sizing: border-box;
      padding: 15px; /* íŒ¨ë”©ì€ ê³µí†µìœ¼ë¡œ ì ìš© */
    }

    /* ----- ìƒë‹¨ íˆ´ë°” ----- */
    .ui-top-bar {
      top: 0;
      left: 0;
      width: 100%;
      height: 40px;
      padding: 5px; /* ìƒë‹¨ë°”ëŠ” íŒ¨ë”© ë”°ë¡œ ì„¤ì • */
      display: flex;
      align-items: center;
      gap: 5px;
      z-index: 20;
    }

    /* ----- ì¢Œì¸¡ ì‚¬ì´ë“œë°” ----- */
    .ui-left-sidebar {
      top: 40px; /* ìƒë‹¨ íˆ´ë°” ë†’ì´ë§Œí¼ ë‚´ë¦¬ê¸° */
      left: 0;
      width: 200px; /* ì´ˆê¸° ë„ˆë¹„ */
      bottom: 0;
      z-index: 10;
    }

    /* ----- ìš°ì¸¡ ì‚¬ì´ë“œë°” ----- */
    .ui-right-sidebar {
      top: 40px; /* ìƒë‹¨ íˆ´ë°” ë†’ì´ë§Œí¼ ë‚´ë¦¬ê¸° */
      right: 0;
      width: 240px; /* ì´ˆê¸° ë„ˆë¹„ */
      bottom: 0;
      z-index: 10;
    }
    
    /* ----- ì‚¬ì´ë“œë°” í¬ê¸° ì¡°ì ˆ í•¸ë“¤ ----- */
    .resizer {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 5px; /* ëˆˆì— ë³´ì´ì§€ ì•Šì§€ë§Œ ì¡ì„ ìˆ˜ ìˆëŠ” ì˜ì—­ */
      cursor: w-resize; /* ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ë³€ê²½í•˜ì—¬ ì¡°ì ˆ ê°€ëŠ¥í•¨ì„ ì•Œë¦¼ */
      z-index: 10; /* ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— ìˆë„ë¡ ì„¤ì • */
    }

    #left-resizer {
      right: -2.5px; /* ì‚¬ì´ë“œë°” ì˜¤ë¥¸ìª½ì— ë¶™ì„ */
    }

    #right-resizer {
      left: -2.5px; /* ì‚¬ì´ë“œë°” ì™¼ìª½ì— ë¶™ì„ */
    }

    /* ----- UI ë‚´ë¶€ ìš”ì†Œ ìŠ¤íƒ€ì¼ ----- */
    .ui-panel h3 {
      margin-top: 0;
      padding-bottom: 5px;
      border-bottom: 1px solid #444;
      font-size: 16px;
    }

    .ui-button {
      background-color: #3c3c3c;
      border: 1px solid #555;
      color: #f0f0f0;
      padding: 5px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 14px;
    }

    .ui-button:hover {
      background-color: #4f4f4f;
    }
  </style>
</head>
<body>
  <div id="main-content">
    <canvas id="renderCanvas"></canvas>
  </div>

  <div class="ui-panel ui-top-bar">
    <button class="ui-button">ğŸ“„ ìƒˆë¡œ ë§Œë“¤ê¸°</button>
    <button class="ui-button">ğŸ“‚ ì—´ê¸°</button>
    <button class="ui-button">ğŸ’¾ ì €ì¥</button>
  </div>

  <div class="ui-panel ui-left-sidebar" id="left-sidebar">
    <div class="resizer" id="left-resizer"></div>
    <h3>ë„êµ¬</h3>
    <button class="ui-button">ì„ íƒ</button>
  </div>

  <div class="ui-panel ui-right-sidebar" id="right-sidebar">
    <div class="resizer" id="right-resizer"></div>
    <h3>ì†ì„±</h3>
    <p>ì„ íƒëœ ì˜¤ë¸Œì íŠ¸ ì—†ìŒ</p>
  </div>
  
  <script type="module" src="./renderer.js"></script>
  <script type="module" src="./upload-pbde.js"></script>

  <script>
    const leftSidebar = document.getElementById('left-sidebar');
    const rightSidebar = document.getElementById('right-sidebar');
    const mainContent = document.getElementById('main-content');

    function updateMainContentLayout() {
        mainContent.style.left = leftSidebar.offsetWidth + 'px';
        mainContent.style.right = rightSidebar.offsetWidth + 'px';
        // renderer.jsì—ì„œ onWindowResizeë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸
        window.dispatchEvent(new Event('resize'));
    }

    function makeResizable(sidebar, resizer) {
      // ë§ˆìš°ìŠ¤ë¥¼ ëˆ„ë¥¸ ì‹œì ì˜ ìƒíƒœë¥¼ ì €ì¥í•  ë³€ìˆ˜
      let initialX = 0;
      let initialWidth = 0;

      resizer.addEventListener('mousedown', (e) => {
        e.preventDefault(); // ê¸°ë³¸ ë“œë˜ê·¸ ë™ì‘ ë°©ì§€

        initialX = e.clientX;
        initialWidth = sidebar.offsetWidth;

        // ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì¼ ë•Œì™€ ë—„ ë•Œì˜ ì´ë²¤íŠ¸ë¥¼ windowì— ë“±ë¡
        window.addEventListener('mousemove', handleMouseMove);
        window.addEventListener('mouseup', handleMouseUp);
      });

      function handleMouseMove(e) {
        // ë§ˆìš°ìŠ¤ ì´ë™ ê±°ë¦¬ ê³„ì‚°
        const deltaX = e.clientX - initialX;
        let newWidth;

        // ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°”ì¸ ê²½ìš°, ë„ˆë¹„ ê³„ì‚° ë°©í–¥ì´ ë°˜ëŒ€
        if (sidebar.id === 'right-sidebar') {
          newWidth = initialWidth - deltaX;
        } else {
          newWidth = initialWidth + deltaX;
        }

        // ìµœì†Œ/ìµœëŒ€ ë„ˆë¹„ ì œí•œ
        if (newWidth > 100 && newWidth < 700) {
          sidebar.style.width = newWidth + 'px';
          updateMainContentLayout();
        }
      }

      function handleMouseUp() {
        // ë§ˆìš°ìŠ¤ë¥¼ ë–¼ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
        window.removeEventListener('mousemove', handleMouseMove);
        window.removeEventListener('mouseup', handleMouseUp);
        
        // ë³€ê²½ëœ ë„ˆë¹„ë¥¼ localStorageì— ì €ì¥
        localStorage.setItem(sidebar.id + '-width', sidebar.style.width);
      }
    }

    function loadSettings() {
        const leftWidth = localStorage.getItem('left-sidebar-width');
        if (leftWidth) {
            leftSidebar.style.width = leftWidth;
        }

        const rightWidth = localStorage.getItem('right-sidebar-width');
        if (rightWidth) {
            rightSidebar.style.width = rightWidth;
        }

        updateMainContentLayout(); // ì €ì¥ëœ ê°’ ë˜ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ë ˆì´ì•„ì›ƒ ì—…ë°ì´íŠ¸
    }

    // ê° ì‚¬ì´ë“œë°”ì— í¬ê¸° ì¡°ì ˆ ê¸°ëŠ¥ ì ìš©
    makeResizable(
      leftSidebar, 
      document.getElementById('left-resizer')
    );
    makeResizable(
      rightSidebar, 
      document.getElementById('right-resizer')
    );

    // ì´ˆê¸° ë¡œë“œ ì‹œ ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
    loadSettings();
  </script>
</body>
</html>